<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StatCalc - Statistical Calculator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .main {
            padding: 40px;
        }
        
        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 768px) {
            .calculator-grid {
                grid-template-columns: 1fr;
                gap: 30px;
            }
        }
        
        .calc-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 30px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .calc-section:hover {
            border-color: #4f46e5;
            transform: translateY(-2px);
        }
        
        .calc-section h3 {
            color: #1e293b;
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #475569;
            font-weight: 500;
        }
        
        .input-group input, .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s ease;
        }
        
        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #4f46e5;
        }
        
        .input-group textarea {
            height: 100px;
            resize: vertical;
            font-family: 'SF Mono', Monaco, monospace;
        }
        
        .btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }
        
        .results {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
        }
        
        .results.active {
            border-color: #10b981;
            background: #f0fdf4;
        }
        
        .stat-result {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .stat-result:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            color: #475569;
            font-weight: 500;
        }
        
        .stat-value {
            color: #1e293b;
            font-weight: 600;
            font-family: 'SF Mono', Monaco, monospace;
        }
        
        .visualization {
            margin-top: 30px;
            text-align: center;
        }
        
        .chart {
            width: 100%;
            height: 300px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>StatCalc</h1>
            <p>Statistical calculations with clear visualizations</p>
        </div>
        
        <div class="main">
            <div class="calculator-grid">
                <!-- Descriptive Statistics -->
                <div class="calc-section">
                    <h3>üìä Descriptive Statistics</h3>
                    <div class="input-group">
                        <label for="data-input">Enter your data (one number per line or comma-separated):</label>
                        <textarea id="data-input" placeholder="1.2, 2.3, 3.1&#10;4.2&#10;5.0, 6.1"></textarea>
                    </div>
                    <button class="btn" onclick="calculateDescriptive()">Calculate Stats</button>
                    
                    <div id="descriptive-results" class="results">
                        <div class="stat-result">
                            <span class="stat-label">Sample Size (n)</span>
                            <span class="stat-value" id="desc-n">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Mean (xÃÑ)</span>
                            <span class="stat-value" id="desc-mean">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Median</span>
                            <span class="stat-value" id="desc-median">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Standard Deviation (s)</span>
                            <span class="stat-value" id="desc-std">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Variance (s¬≤)</span>
                            <span class="stat-value" id="desc-var">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Min / Max</span>
                            <span class="stat-value" id="desc-range">-</span>
                        </div>
                    </div>
                    
                    <div class="visualization">
                        <canvas id="histogram" class="chart"></canvas>
                    </div>
                </div>
                
                <!-- Confidence Intervals -->
                <div class="calc-section">
                    <h3>üìè Confidence Intervals</h3>
                    <div class="input-group">
                        <label for="ci-mean">Sample Mean (xÃÑ):</label>
                        <input type="number" id="ci-mean" step="any" placeholder="e.g., 23.5">
                    </div>
                    <div class="input-group">
                        <label for="ci-std">Sample Standard Deviation (s):</label>
                        <input type="number" id="ci-std" step="any" placeholder="e.g., 4.2">
                    </div>
                    <div class="input-group">
                        <label for="ci-n">Sample Size (n):</label>
                        <input type="number" id="ci-n" placeholder="e.g., 30">
                    </div>
                    <div class="input-group">
                        <label for="ci-level">Confidence Level:</label>
                        <select id="ci-level">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="btn" onclick="calculateCI()">Calculate CI</button>
                    
                    <div id="ci-results" class="results">
                        <div class="stat-result">
                            <span class="stat-label">Margin of Error</span>
                            <span class="stat-value" id="ci-margin">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Lower Bound</span>
                            <span class="stat-value" id="ci-lower">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Upper Bound</span>
                            <span class="stat-value" id="ci-upper">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Confidence Interval</span>
                            <span class="stat-value" id="ci-interval">-</span>
                        </div>
                    </div>
                </div>
                
                <!-- Hypothesis Testing -->
                <div class="calc-section">
                    <h3>üéØ One-Sample t-Test</h3>
                    <div class="input-group">
                        <label for="t-mean">Sample Mean (xÃÑ):</label>
                        <input type="number" id="t-mean" step="any" placeholder="e.g., 23.5">
                    </div>
                    <div class="input-group">
                        <label for="t-std">Sample Standard Deviation (s):</label>
                        <input type="number" id="t-std" step="any" placeholder="e.g., 4.2">
                    </div>
                    <div class="input-group">
                        <label for="t-n">Sample Size (n):</label>
                        <input type="number" id="t-n" placeholder="e.g., 30">
                    </div>
                    <div class="input-group">
                        <label for="t-null">Null Hypothesis Mean (Œº‚ÇÄ):</label>
                        <input type="number" id="t-null" step="any" placeholder="e.g., 20.0">
                    </div>
                    <button class="btn" onclick="calculateTTest()">Run t-Test</button>
                    
                    <div id="ttest-results" class="results">
                        <div class="stat-result">
                            <span class="stat-label">t-statistic</span>
                            <span class="stat-value" id="t-stat">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Degrees of Freedom</span>
                            <span class="stat-value" id="t-df">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">p-value (two-tailed)</span>
                            <span class="stat-value" id="t-pvalue">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Result (Œ± = 0.05)</span>
                            <span class="stat-value" id="t-result">-</span>
                        </div>
                    </div>
                </div>
                
                <!-- Sample Size Calculator -->
                <div class="calc-section">
                    <h3>üìê Sample Size Calculator</h3>
                    <div class="input-group">
                        <label for="ss-effect">Effect Size (Cohen's d):</label>
                        <input type="number" id="ss-effect" step="any" placeholder="e.g., 0.5" value="0.5">
                    </div>
                    <div class="input-group">
                        <label for="ss-power">Statistical Power:</label>
                        <select id="ss-power">
                            <option value="0.7">70%</option>
                            <option value="0.8" selected>80%</option>
                            <option value="0.9">90%</option>
                            <option value="0.95">95%</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="ss-alpha">Significance Level (Œ±):</label>
                        <select id="ss-alpha">
                            <option value="0.01">0.01</option>
                            <option value="0.05" selected>0.05</option>
                            <option value="0.1">0.10</option>
                        </select>
                    </div>
                    <button class="btn" onclick="calculateSampleSize()">Calculate Sample Size</button>
                    
                    <div id="samplesize-results" class="results">
                        <div class="stat-result">
                            <span class="stat-label">Required Sample Size (n)</span>
                            <span class="stat-value" id="ss-n">-</span>
                        </div>
                        <div class="stat-result">
                            <span class="stat-label">Effect Size Interpretation</span>
                            <span class="stat-value" id="ss-interpretation">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Statistical functions
        function mean(arr) {
            return arr.reduce((a, b) => a + b, 0) / arr.length;
        }
        
        function median(arr) {
            const sorted = [...arr].sort((a, b) => a - b);
            const mid = Math.floor(sorted.length / 2);
            return sorted.length % 2 === 0 
                ? (sorted[mid - 1] + sorted[mid]) / 2 
                : sorted[mid];
        }
        
        function variance(arr) {
            const m = mean(arr);
            return arr.reduce((a, b) => a + Math.pow(b - m, 2), 0) / (arr.length - 1);
        }
        
        function standardDeviation(arr) {
            return Math.sqrt(variance(arr));
        }
        
        function parseData(input) {
            return input.replace(/\n/g, ',')
                       .split(',')
                       .map(x => parseFloat(x.trim()))
                       .filter(x => !isNaN(x));
        }
        
        // t-distribution functions (approximations)
        function tCritical(df, alpha) {
            // Simplified approximation for common cases
            const criticalValues = {
                0.10: { 1: 3.078, 5: 1.476, 10: 1.372, 20: 1.325, 30: 1.310, Infinity: 1.282 },
                0.05: { 1: 6.314, 5: 2.015, 10: 1.812, 20: 1.725, 30: 1.697, Infinity: 1.960 },
                0.01: { 1: 31.821, 5: 3.365, 10: 2.764, 20: 2.528, 30: 2.457, Infinity: 2.576 }
            };
            
            const table = criticalValues[alpha];
            if (df >= 30) return table[Infinity];
            
            const dfs = Object.keys(table).map(Number).sort((a, b) => a - b);
            for (let i = 0; i < dfs.length - 1; i++) {
                if (df <= dfs[i]) return table[dfs[i]];
            }
            return table[30];
        }
        
        function tPValue(t, df) {
            // Rough approximation - in real app would use proper library
            t = Math.abs(t);
            if (df >= 30) {
                // Use normal approximation
                const z = t;
                return 2 * (1 - normalCDF(z));
            }
            
            // Simplified lookup for common cases
            if (t < 1.0) return 0.4;
            if (t < 1.5) return 0.2;
            if (t < 2.0) return 0.1;
            if (t < 2.5) return 0.05;
            if (t < 3.0) return 0.01;
            return 0.001;
        }
        
        function normalCDF(z) {
            return 0.5 * (1 + erf(z / Math.sqrt(2)));
        }
        
        function erf(x) {
            // Approximation of error function
            const a1 = 0.254829592;
            const a2 = -0.284496736;
            const a3 = 1.421413741;
            const a4 = -1.453152027;
            const a5 = 1.061405429;
            const p = 0.3275911;
            
            const sign = x >= 0 ? 1 : -1;
            x = Math.abs(x);
            
            const t = 1.0 / (1.0 + p * x);
            const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
            
            return sign * y;
        }
        
        // Calculator functions
        function calculateDescriptive() {
            const input = document.getElementById('data-input').value;
            const data = parseData(input);
            
            if (data.length === 0) {
                alert('Please enter valid numeric data');
                return;
            }
            
            const results = {
                n: data.length,
                mean: mean(data),
                median: median(data),
                std: standardDeviation(data),
                var: variance(data),
                min: Math.min(...data),
                max: Math.max(...data)
            };
            
            document.getElementById('desc-n').textContent = results.n;
            document.getElementById('desc-mean').textContent = results.mean.toFixed(3);
            document.getElementById('desc-median').textContent = results.median.toFixed(3);
            document.getElementById('desc-std').textContent = results.std.toFixed(3);
            document.getElementById('desc-var').textContent = results.var.toFixed(3);
            document.getElementById('desc-range').textContent = `${results.min.toFixed(3)} / ${results.max.toFixed(3)}`;
            
            document.getElementById('descriptive-results').classList.add('active');
            
            // Draw simple histogram
            drawHistogram(data);
        }
        
        function calculateCI() {
            const mean = parseFloat(document.getElementById('ci-mean').value);
            const std = parseFloat(document.getElementById('ci-std').value);
            const n = parseInt(document.getElementById('ci-n').value);
            const level = parseInt(document.getElementById('ci-level').value);
            
            if (isNaN(mean) || isNaN(std) || isNaN(n)) {
                alert('Please enter valid numbers');
                return;
            }
            
            const alpha = (100 - level) / 100;
            const df = n - 1;
            const t = tCritical(df, alpha);
            const se = std / Math.sqrt(n);
            const margin = t * se;
            
            const lower = mean - margin;
            const upper = mean + margin;
            
            document.getElementById('ci-margin').textContent = margin.toFixed(3);
            document.getElementById('ci-lower').textContent = lower.toFixed(3);
            document.getElementById('ci-upper').textContent = upper.toFixed(3);
            document.getElementById('ci-interval').textContent = `[${lower.toFixed(3)}, ${upper.toFixed(3)}]`;
            
            document.getElementById('ci-results').classList.add('active');
        }
        
        function calculateTTest() {
            const sampleMean = parseFloat(document.getElementById('t-mean').value);
            const std = parseFloat(document.getElementById('t-std').value);
            const n = parseInt(document.getElementById('t-n').value);
            const nullMean = parseFloat(document.getElementById('t-null').value);
            
            if (isNaN(sampleMean) || isNaN(std) || isNaN(n) || isNaN(nullMean)) {
                alert('Please enter valid numbers');
                return;
            }
            
            const se = std / Math.sqrt(n);
            const t = (sampleMean - nullMean) / se;
            const df = n - 1;
            const pValue = tPValue(t, df);
            
            const result = pValue < 0.05 ? 'Reject H‚ÇÄ' : 'Fail to reject H‚ÇÄ';
            
            document.getElementById('t-stat').textContent = t.toFixed(3);
            document.getElementById('t-df').textContent = df;
            document.getElementById('t-pvalue').textContent = pValue.toFixed(4);
            document.getElementById('t-result').textContent = result;
            
            document.getElementById('ttest-results').classList.add('active');
        }
        
        function calculateSampleSize() {
            const effect = parseFloat(document.getElementById('ss-effect').value);
            const power = parseFloat(document.getElementById('ss-power').value);
            const alpha = parseFloat(document.getElementById('ss-alpha').value);
            
            if (isNaN(effect) || isNaN(power) || isNaN(alpha)) {
                alert('Please enter valid numbers');
                return;
            }
            
            // Cohen's formula for one-sample t-test
            const z_alpha = alpha === 0.05 ? 1.96 : (alpha === 0.01 ? 2.58 : 1.28);
            const z_beta = power === 0.8 ? 0.84 : (power === 0.9 ? 1.28 : (power === 0.95 ? 1.64 : 0.52));
            
            const n = Math.ceil(Math.pow((z_alpha + z_beta) / effect, 2));
            
            let interpretation = '';
            if (effect < 0.2) interpretation = 'Very small';
            else if (effect < 0.5) interpretation = 'Small';
            else if (effect < 0.8) interpretation = 'Medium';
            else interpretation = 'Large';
            
            document.getElementById('ss-n').textContent = n;
            document.getElementById('ss-interpretation').textContent = interpretation;
            
            document.getElementById('samplesize-results').classList.add('active');
        }
        
        function drawHistogram(data) {
            const canvas = document.getElementById('histogram');
            const ctx = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = canvas.offsetWidth * devicePixelRatio;
            canvas.height = canvas.offsetHeight * devicePixelRatio;
            ctx.scale(devicePixelRatio, devicePixelRatio);
            
            const width = canvas.offsetWidth;
            const height = canvas.offsetHeight;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            // Calculate histogram
            const min = Math.min(...data);
            const max = Math.max(...data);
            const bins = Math.min(10, Math.ceil(Math.sqrt(data.length)));
            const binWidth = (max - min) / bins;
            
            const histogram = Array(bins).fill(0);
            data.forEach(value => {
                let bin = Math.floor((value - min) / binWidth);
                if (bin === bins) bin = bins - 1; // Handle max value
                histogram[bin]++;
            });
            
            const maxCount = Math.max(...histogram);
            
            // Draw histogram
            const padding = 40;
            const barWidth = (width - 2 * padding) / bins;
            const chartHeight = height - 2 * padding;
            
            ctx.fillStyle = '#4f46e5';
            histogram.forEach((count, i) => {
                const barHeight = (count / maxCount) * chartHeight;
                const x = padding + i * barWidth;
                const y = height - padding - barHeight;
                
                ctx.fillRect(x, y, barWidth * 0.8, barHeight);
            });
            
            // Draw axes
            ctx.strokeStyle = '#64748b';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, height - padding);
            ctx.lineTo(width - padding, height - padding);
            ctx.stroke();
            
            // Labels
            ctx.fillStyle = '#64748b';
            ctx.font = '12px SF Pro Display, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Distribution of Values', width / 2, 20);
        }
    </script>
</body>
</html>